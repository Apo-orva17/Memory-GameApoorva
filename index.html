<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vault‑Tec Memory — Pip‑Boy Edition</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Inter:wght@300;500;700&display=swap"
    rel="stylesheet">

  <style>
    :root {
      --vault-blue: #052c6b;
      --vault-yellow: #ffd23f;
      --muted: #b6c2d8;
      --panel: #0b1730;
      --glass: rgba(255, 255, 255, 0.04);
      --card-back: #0a2340;
      --accent-glow: 0 6px 30px rgba(37, 152, 255, 0.12);
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      min-height: 100%;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 700px at 10% 10%, rgba(2, 46, 84, 0.5), transparent),
        radial-gradient(900px 500px at 90% 90%, rgba(3, 20, 60, 0.45), transparent),
        linear-gradient(180deg, #001021 0%, #021232 60%);
      color: var(--muted);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: 2.4rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .app {
      width: 100%;
      max-width: 1100px;
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 2rem;
      align-items: start;
    }

    .panel {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), transparent);
      border: 1px solid rgba(255, 255, 255, 0.04);
      border-radius: 14px;
      padding: 1.6rem;
      box-shadow: var(--accent-glow);
      min-height: 420px;
    }

    .brand {
      display: flex;
      gap: 0.8rem;
      align-items: center;
      margin-bottom: 1rem;
    }

    .vault-badge {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      background: linear-gradient(180deg, var(--vault-blue), #123a78);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--vault-yellow);
      font-weight: 700;
      font-family: 'Share Tech Mono', monospace;
      border: 2px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 6px 24px rgba(17, 68, 128, 0.25), inset 0 -8px 20px rgba(0, 0, 0, 0.4);
      font-size: 1.6rem;
    }

    h1.title {
      font-size: 1.35rem;
      margin: 0;
      color: var(--vault-yellow);
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 0.08rem;
      text-transform: uppercase;
      font-weight: 700
    }

    .subtitle {
      font-size: 0.92rem;
      color: var(--muted);
      margin-top: 0.35rem
    }

    .score-box {
      margin-top: 1.4rem;
      background: var(--panel);
      padding: 1rem;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.03)
    }

    .score-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.8rem
    }

    .score-row .label {
      font-size: 0.86rem;
      color: var(--muted)
    }

    .score-big {
      font-weight: 700;
      color: var(--vault-yellow);
      font-size: 1.4rem
    }

    .stars {
      display: flex;
      gap: 0.4rem;
      align-items: center
    }

    .star {
      width: 40px;
      height: 32px;
      border-radius: 6px;
      background: linear-gradient(180deg, var(--vault-yellow), #f7c84b);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #00142b
    }

    .star--lost {
      opacity: 0.18;
      filter: grayscale(1)
    }

    .timer-panel {
      display: flex;
      gap: 0.6rem;
      align-items: center
    }

    .timer-value {
      background: linear-gradient(90deg, #021a43, #06254f);
      padding: 0.45rem 0.8rem;
      border-radius: 8px;
      color: var(--muted);
      font-family: 'Share Tech Mono', monospace
    }

    .controls {
      display: flex;
      gap: 0.6rem;
      margin-top: 1rem
    }

    .btn {
      border: none;
      padding: 0.6rem 0.9rem;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      background: linear-gradient(180deg, var(--vault-yellow), #f0c33a);
      color: #021021;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.35);
    }

    .btn.ghost {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.04);
      color: var(--muted)
    }

    .hint {
      margin-top: 1rem;
      font-size: 0.84rem;
      color: #9fb6d9
    }

    .game {
      padding: 1.2rem;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), transparent);
      border: 1px solid rgba(255, 255, 255, 0.03);
      min-height: 420px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem
    }

    .top-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between
    }

    .progress {
      font-family: 'Share Tech Mono', monospace;
      color: var(--muted);
      font-size: 0.9rem
    }

    .deck {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      width: 100%;
      max-width: 720px;
      padding: 1rem;
      align-content: center;
      justify-items: center;
    }

    .card {
      width: 140px;
      height: 140px;
      border-radius: 12px;
      perspective: 1000px;
      user-select: none;
      position: relative;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.45s cubic-bezier(.2, .9, .2, 1);
    }

    /* Enhanced Flip Animation */
    .card.is-flip .card-inner {
      transform: rotateY(180deg) scale(1.05);
      transition: transform 0.4s cubic-bezier(.68,-0.55,.265,1.55);
    }

    .card-face {
      position: absolute;
      inset: 0;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      backface-visibility: hidden;
      border: 1px solid rgba(255, 255, 255, 0.03)
    }

    .card-back {
      background: linear-gradient(180deg, var(--card-back), #041a37);
      box-shadow: inset 0 -8px 30px rgba(0, 0, 0, 0.6);
    }

    .card-back .logo {
      font-family: 'Share Tech Mono', monospace;
      color: var(--vault-yellow);
      font-weight: 700;
      font-size: 1.4rem
    }

    .card-front {
      transform: rotateY(180deg);
      background: #ffffff;
      border: 1px solid rgba(0, 0, 0, 0.06);
      display: flex;
      align-items: center;
      justify-content: center
    }

    .card-front img {
      max-width: 84%;
      max-height: 84%;
      display: block;
      border-radius: 6px
    }

    .card.match .card-inner {
      animation: matchPulse 0.9s ease-in-out 1, matchGlow 0.8s ease-in-out 1;
    }

    @keyframes matchPulse {
      0% {
        transform: scale(1)
      }

      50% {
        transform: scale(1.06)
      }

      100% {
        transform: scale(1)
      }
    }

    @keyframes matchGlow {
      0% {
        box-shadow: 0 0 0 rgba(255, 215, 63, 0.5);
      }

      50% {
        box-shadow: 0 0 20px rgba(255, 215, 63, 0.8);
      }

      100% {
        box-shadow: 0 0 0 rgba(255, 215, 63, 0.5);
      }
    }

    /* Difficulty Selector */
    #difficulty {
      margin-top: 1rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    #difficulty select {
      padding: 0.4rem 0.6rem;
      border-radius: 6px;
      border: none;
      font-family: 'Share Tech Mono', monospace;
      font-weight: 500;
    }

    @media (max-width: 900px) {
      .app {
        grid-template-columns: 1fr;
        max-width: 920px
      }

      .panel {
        order: 2
      }

      .game {
        order: 1
      }

      .deck {
        grid-template-columns: repeat(4, 1fr);
        gap: 12px
      }

      .card {
        width: 110px;
        height: 110px
      }
    }

    @media (max-width: 480px) {
      .deck {
        grid-template-columns: repeat(2, 1fr)
      }

      .card {
        width: 98px;
        height: 98px
      }

      .panel {
        min-height: auto
      }
    }
  </style>
</head>

<body>
  <div class="app" role="application" aria-label="Vault‑Tec Memory Game">
    <aside class="panel" aria-hidden="false">
      <div class="brand">
        <div class="vault-badge">VT</div>
        <div>
          <h1 class="title">Vault‑Tec Memory</h1>
          <div class="subtitle">Pip‑Boy Training — Find all Tech Pairs</div>
        </div>
      </div>

      <div class="score-box">
        <div class="score-row">
          <div>
            <div class="label">Moves</div>
            <div class="score-big" id="moves">0</div>
          </div>
          <div>
            <div class="label">Time</div>
            <div class="score-big" id="time">00:00</div>
          </div>
        </div>

        <div style="display:flex;align-items:center;justify-content:space-between;gap:0.6rem">
          <div>
            <div class="label">Star Rating</div>
            <div class="stars" id="star-rating">
              <div class="star" data-star="1">★</div>
              <div class="star" data-star="2">★</div>
              <div class="star" data-star="3">★</div>
            </div>
          </div>

          <div style="text-align:right">
            <div class="label">Pairs</div>
            <div class="score-big" id="pairs">0 / 8</div>
          </div>
        </div>

        <div id="difficulty">
          <div class="label">Difficulty:</div>
          <select id="difficultySelect">
            <option value="easy">Easy (4 pairs)</option>
            <option value="medium" selected>Medium (8 pairs)</option>
            <option value="hard">Hard (12 pairs)</option>
          </select>
        </div>

        <div class="controls">
          <button class="btn" id="restart">Restart</button>
          <button class="btn ghost" id="hint">Reveal 1 Pair</button>
        </div>

        <div class="hint">Tip: Try to remember positions — the Pip‑Boy rewards patience.</div>
      </div>
    </aside>

    <main class="game">
      <div class="top-row">
        <div class="progress">Find all pairs — Good luck, Vault Dweller.</div>
      </div>

      <section class="deck" id="deck" aria-live="polite" aria-label="Game cards"></section>

      <div style="width:100%;display:flex;align-items:center;justify-content:center">
        <button class="btn" id="restart-bottom">Restart Game</button>
      </div>

    </main>
  </div>

  <div class="modal-overlay" id="modalOverlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-box" role="document">
      <h2>CONGRATULATIONS, Vault Dweller</h2>
      <div class="subtitle">You matched all pairs — Vault‑Tec is proud.</div>

      <div class="modal-stats" id="modalStats"></div>

      <div style="display:flex;gap:0.6rem;margin-top:1rem;justify-content:flex-end">
        <button class="btn ghost" id="closeModal">Close</button>
        <button class="btn" id="playAgain">Play Again</button>
      </div>
    </div>
  </div>

  <script>
    const cardPoolFull = [
      'Agility.png', 'Agility.png',
      'Boat.png', 'Boat.png',
      'Citizenship.png', 'Citizenship.png',
      'Hack.png', 'Hack.png',
      'Nerd-Rage.png', 'Nerd-Rage.png',
      'Nuka-Cola.png', 'Nuka-Cola.png',
      'Robotics.png', 'Robotics.png',
      'Shock.png', 'Shock.png'
    ];

    const deckEl = document.getElementById('deck');
    const movesEl = document.getElementById('moves');
    const timeEl = document.getElementById('time');
    const pairsEl = document.getElementById('pairs');
    const starsEl = document.getElementById('star-rating');
    const restartBtn = document.getElementById('restart');
    const restartBottom = document.getElementById('restart-bottom');
    const hintBtn = document.getElementById('hint');
    const modal = document.getElementById('modalOverlay');
    const playAgainBtn = document.getElementById('playAgain');
    const closeModalBtn = document.getElementById('closeModal');
    const modalStats = document.getElementById('modalStats');
    const difficultySelect = document.getElementById('difficultySelect');

    // Game state
    let deck = [];
    let opened = [];
    let matched = 0;
    let moves = 0;
    let starCount = 3;
    let timerId = null;
    let seconds = 0;
    let minutes = 0;
    let started = false;
    let maxPairs = 8; // default medium

    function shuffle(a) {
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function formatTime(min, sec) {
      const mm = String(min).padStart(2, '0');
      const ss = String(sec).padStart(2, '0');
      return mm + ':' + ss;
    }

    function startTimer() {
      if (timerId) return;
      timerId = setInterval(() => {
        seconds++;
        if (seconds >= 60) { minutes++; seconds = 0 }
        timeEl.textContent = formatTime(minutes, seconds);
      }, 1000)
    }

    function stopTimer() {
      if (timerId) { clearInterval(timerId); timerId = null }
    }

    function resetTimer() { stopTimer(); seconds = 0; minutes = 0; timeEl.textContent = '00:00' }

    function buildDeck() {
      deckEl.innerHTML = '';
      deck = [];

      // Select cards based on difficulty
      let cardPool;
      const diff = difficultySelect.value;
      if (diff === 'easy') {
        cardPool = cardPoolFull.slice(0, 8); // 4 pairs
        maxPairs = 4;
      } else if (diff === 'medium') {
        cardPool = cardPoolFull.slice(0, 16); // 8 pairs
        maxPairs = 8;
      } else {
        cardPool = cardPoolFull.concat(['Extra1.png', 'Extra1.png', 'Extra2.png', 'Extra2.png']); // 12 pairs
        maxPairs = 12;
      }

      pairsEl.textContent = `0 / ${maxPairs}`;
      deck = shuffle([...cardPool]);

      deck.forEach(src => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.src = src;
        card.innerHTML = `
          <div class="card-inner">
            <div class="card-face card-back"><span class="logo">VT</span></div>
            <div class="card-face card-front"><img src="img/${src}" alt="Card Image"></div>
          </div>
        `;
        deckEl.appendChild(card);
      });
    }

    function resetGame() {
      buildDeck();
      opened = [];
      matched = 0;
      moves = 0;
      starCount = 3;
      movesEl.textContent = moves;
      resetStars();
      resetTimer();
      started = false;
    }

    function resetStars() {
      Array.from(starsEl.children).forEach((star, i) => {
        star.classList.toggle('star--lost', i >= starCount);
      });
    }

    function revealHint() {
      const unmatched = Array.from(deckEl.querySelectorAll('.card:not(.match):not(.is-flip)'));
      if (unmatched.length < 2) return;
      const pair = shuffle(unmatched).slice(0, 2);
      pair.forEach(c => { c.classList.add('is-flip') });
      setTimeout(() => pair.forEach(c => c.classList.remove('is-flip')), 1000);
    }

    function checkMatch() {
      const [first, second] = opened;
      if (first.dataset.src === second.dataset.src) {
        first.classList.add('match');
        second.classList.add('match');
        matched++;
        pairsEl.textContent = `${matched} / ${maxPairs}`;
      } else {
        setTimeout(() => {
          first.classList.remove('is-flip');
          second.classList.remove('is-flip');
        }, 600);
      }
      opened = [];
    }

    function handleCardClick(e) {
      const card = e.currentTarget;
      if (card.classList.contains('is-flip') || card.classList.contains('match')) return;
      if (!started) { startTimer(); started = true }

      card.classList.add('is-flip');
      opened.push(card);

      if (opened.length === 2) {
        moves++;
        movesEl.textContent = moves;

        // Star Rating Logic
        if (moves > maxPairs * 2) starCount = 2;
        if (moves > maxPairs * 3) starCount = 1;
        resetStars();

        checkMatch();
      }

      if (matched === maxPairs) {
        stopTimer();
        showModal();
      }
    }

    function showModal() {
      modalStats.innerHTML = `<div>Moves: ${moves}</div><div>Time: ${formatTime(minutes, seconds)}</div><div>Stars: ${starCount} ★</div>`;
      modal.style.display = 'flex';
    }

    // Event Listeners
    restartBtn.addEventListener('click', resetGame);
    restartBottom.addEventListener('click', resetGame);
    playAgainBtn.addEventListener('click', () => { modal.style.display = 'none'; resetGame(); });
    closeModalBtn.addEventListener('click', () => { modal.style.display = 'none' });
    hintBtn.addEventListener('click', revealHint);
    difficultySelect.addEventListener('change', resetGame);

    deckEl.addEventListener('click', function (e) {
      if (!e.target.closest('.card')) return;
      handleCardClick({ currentTarget: e.target.closest('.card') });
    });

    // Initialize
    resetGame();
  </script>
</body>

</html>
